import{a as I}from"./chunk-MZG3V2G2.js";import{a as B}from"./chunk-BMQE7F7G.js";import{$b as S,Bb as _,Eb as C,Ga as g,Gb as y,La as b,Lb as M,Wa as c,Ya as m,Za as f,_a as h,_b as E,a as k,b as v,db as o,eb as n,fb as p,jb as s,sb as x,tb as r,ub as u,vb as l,wa as a}from"./chunk-NDO7E3F7.js";var T=(i,t)=>t.ticketID;function A(i,t){i&1&&p(0,"span",6)}function L(i,t){if(i&1&&(o(0,"div",8),r(1),n()),i&2){let e=s();a(),l(" ",e.errorMessage," ")}}function j(i,t){i&1&&(o(0,"div",9),p(1,"i",11),o(2,"h5",12),r(3,"No bookings found"),n(),o(4,"p",12),r(5,"Start exploring movies and reserve your seats now."),n()())}function N(i,t){if(i&1&&(o(0,"p",18),r(1),C(2,"date"),n()),i&2){let e=s().$implicit;a(),l(" Booked on ",y(2,1,e.bookedAt,"medium")," ")}}function R(i,t){if(i&1&&(o(0,"div",13)(1,"div",14)(2,"div")(3,"h5",15),r(4),n(),o(5,"p",16),r(6),n(),o(7,"p",17)(8,"strong"),r(9,"Seats:"),n(),r(10),n()(),o(11,"span"),r(12),n()(),c(13,N,3,4,"p",18),n()),i&2){let e=t.$implicit,d=s(3);a(4),u(e.movieName),a(2),u(e.theatreName),a(4),l(" ",e.seatNumbers||e.numberOfSeats+" seat(s)"," "),a(),x(_("badge px-3 py-2 ",d.getStatusBadgeClass(e))),a(),l(" ",d.getStatusLabel(e)," "),a(),m(e.bookedAt?13:-1)}}function V(i,t){if(i&1&&(o(0,"div",10),f(1,R,14,8,"div",13,T),n()),i&2){let e=s(2);a(),h(e.bookings)}}function F(i,t){if(i&1&&c(0,j,6,0,"div",9)(1,V,3,0,"div",10),i&2){let e=s();m(e.noBookings&&!e.isLoading?0:1)}}var w=class i{constructor(t,e,d){this.ticketService=t;this.authService=e;this.cdr=d}bookings=[];isLoading=!1;errorMessage="";userId=null;noBookings=!1;ngOnInit(){if(this.userId=this.authService.userID,!this.userId){this.errorMessage="You must be logged in to view your bookings.";return}this.loadBookings()}loadBookings(){this.userId&&(this.isLoading=!0,this.errorMessage="",this.noBookings=!1,this.ticketService.getUserBookings(this.userId).subscribe({next:t=>{this.bookings=this.applyDerivedStatuses(t??[]),this.noBookings=this.bookings.length===0,this.isLoading=!1,this.cdr.detectChanges()},error:t=>{this.isLoading=!1,t?.status===404?(this.noBookings=!0,this.bookings=[]):this.errorMessage=t?.error?.message||"Failed to load bookings. Please try again later.",this.cdr.detectChanges()}}))}trackByTicketId(t,e){return e.ticketID}applyDerivedStatuses(t){let e=["Confirmed","Upcoming","Seen","Checked-In","Completed","Archived"];return t.map((d,O)=>{let P=t.length-O-1,D=e[Math.min(P,e.length-1)];return v(k({},d),{derivedStatus:D})})}getStatusLabel(t){return t.derivedStatus}getStatusBadgeClass(t){switch(t.derivedStatus){case"Confirmed":return"bg-success";case"Upcoming":return"bg-warning text-dark";case"Seen":return"bg-secondary";case"Checked-In":return"bg-info text-dark";case"Completed":return"bg-secondary";case"Archived":default:return"bg-dark"}}static \u0275fac=function(e){return new(e||i)(g(I),g(B),g(M))};static \u0275cmp=b({type:i,selectors:[["app-my-bookings"]],decls:11,vars:2,consts:[[1,"my-bookings","container","py-5"],[1,"row","justify-content-center"],[1,"col-lg-10"],[1,"card","shadow-sm","border-0"],[1,"card-header","bg-primary","text-white","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"card-body"],["role","alert",1,"alert","alert-danger"],[1,"empty-state","text-center","py-5"],[1,"booking-list"],["aria-hidden","true",1,"fa","fa-ticket","fa-3x","text-muted","mb-3"],[1,"text-muted"],[1,"booking-item","border","rounded-3","p-4","mb-3","shadow-sm"],[1,"d-flex","justify-content-between","align-items-start","flex-wrap","gap-2"],[1,"mb-1"],[1,"mb-1","text-muted"],[1,"mb-0","w-100","text-break"],[1,"mb-0","mt-3","text-muted","small"]],template:function(e,d){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),r(6,"My Bookings"),n(),c(7,A,1,0,"span",6),n(),o(8,"div",7),c(9,L,2,1,"div",8)(10,F,2,1),n()()()()()),e&2&&(a(7),m(d.isLoading?7:-1),a(2),m(d.errorMessage?9:10))},dependencies:[S,E],styles:[".my-bookings[_ngcontent-%COMP%]{min-height:100vh}.card[_ngcontent-%COMP%]{border-radius:16px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{border-radius:16px 16px 0 0;padding:1.75rem}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.75rem}.booking-list[_ngcontent-%COMP%]   .booking-item[_ngcontent-%COMP%]{background-color:#fff;transition:transform .2s ease,box-shadow .2s ease}.booking-list[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #00000014}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.5}.my-bookings[_ngcontent-%COMP%]{padding-top:2rem}.my-bookings[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.25rem}.my-bookings[_ngcontent-%COMP%]   .booking-item[_ngcontent-%COMP%]{padding:1.5rem}"]})};export{w as MyBookings};
